id: CVE-2024-4367

info:
  name: PDF.js Arbitrary JavaScript Execution Vulnerability
  author: s1d6p01nt7
  severity: high
  description: |
    This template detects the CVE-2024-4367 vulnerability in PDF.js, which allows arbitrary JavaScript execution through manipulated FontMatrix entries in PDF metadata.
  reference:
    - https://codeanlabs.com/blog/research/cve-2024-4367-arbitrary-js-execution-in-pdf-js/
    - https://bugzilla.mozilla.org/show_bug.cgi?id=1893645
    - https://lists.debian.org/debian-lts-announce/2024/05/msg00010.html
    - https://lists.debian.org/debian-lts-announce/2024/05/msg00012.html
    - https://www.mozilla.org/security/advisories/mfsa2024-21/
  classification:
    epss-score: 0.00044
    epss-percentile: 0.11858

http:
  - raw:
      - |
        GET /path/to/malicious_pdf.pdf HTTP/1.1
        Host: {{Hostname}}
        Accept: application/pdf

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "/FontMatrix \\[.*\\(0\\); alert\\('foobar'\\)\\].*\\]/"
      - type: word
        part: header
        words:
          - "application/pdf"