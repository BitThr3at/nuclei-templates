id: CVE-2024-53677

info:
  name: Apache Struts File Upload RCE Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Apache Struts 2 vulnerability (CVE-2024-53677) in the file upload logic allows path traversal and malicious file uploads, potentially leading to remote code execution (RCE).
  tags: apache,struts,rce,file-upload

http:
  - raw:
      - |
        GET /struts2-showcase/ HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "compare_versions(version, '>=2.0.0', '<=2.3.37') || compare_versions(version, '>=2.5.0', '<=2.5.33') || compare_versions(version, '>=6.0.0', '<=6.3.0.2')"
      - type: regex
        regex:
          - "Struts2"