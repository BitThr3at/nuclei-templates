id: exposed-env-file

info:
  name: Exposed .env File Detection
  author: Abu Hurayra
  severity: high
  description: Detects exposed .env files, which may contain sensitive credentials, API keys, and other configuration information.
  tags: config,env,sensitive,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}/.env"

    matchers:
      - type: word
        words:
          - "DB_PASSWORD"
          - "DB_USERNAME"
          - "API_KEY"

      - type: regex
        regex:
          - "(DB_PASSWORD|API_KEY|AWS_ACCESS_KEY_ID|SECRET|DB_HOST)"

    extractors:
      - type: regex
        regex:
          - "(DB_PASSWORD|DB_USERNAME|API_KEY|AWS_SECRET_ACCESS_KEY|DB_HOST).+"
