id: tls-session-renegotiation-vulnerability

info:
  name: TLS Session Renegotiation Vulnerability
  author: ProjectDiscoveryAI
  severity: high
  description: |
    TLS session renegotiation vulnerability allows an attacker to exploit the renegotiation feature of the TLS protocol. This can lead to a man-in-the-middle (MITM) attack where malicious actors can inject requests into the communication stream between a client and server, potentially compromising sensitive information.
  remediation: |
    Disable TLS renegotiation on the server or update to a version of the server software that has patched this vulnerability. Ensure that the server is configured to use secure cipher suites and follows best practices for TLS configuration.

tcp:
  - inputs:
      - data: "R"
    host:
      - "tls://{{Hostname}}"
    port: 443
    read-size: 2048
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "RENEGOTIATING"
        part: raw
      - type: regex
        regex:
          - "depth=[0-9]+.*verify return:1"
        part: raw